# Лабораторная работа №2

**Тема:** Bash-скрипты для работы с CLI, резервным копированием и мониторингом диска

**Студент:** Славов Константин, группа I2302

---

## Цель работы

Изучить основы написания bash-скриптов, включая ввод/вывод, условия, циклы, обработку аргументов, валидацию данных и работу с системными командами Linux.
В рамках лабораторной работы были реализованы три скрипта:

1. `cli_assistant.sh` — CLI-ассистент с приветствием и отчётом о системе.
2. `backup_rot.sh` — резервное копирование каталога с логированием и ротацией.
3. `disk_monitor.sh` — мониторинг дискового пространства с пороговым предупреждением.

---

## Задание 1 — CLI-ассистент

### Цель

Научиться взаимодействовать с пользователем через консоль, применять условия и команды системной информации.

### Ход выполнения

Создан скрипт **`cli_assistant.sh`**, выполняющий:

* запрос имени и отдела пользователя (с валидацией до 3 попыток);
* вывод мини-отчёта с текущей датой, аптаймом, именем хоста, свободным местом и числом пользователей;
* финальное приветствие вида
  **«Здравствуйте, <Имя> (<Отдел|не указан>)!»**

#### Использованные команды:

`read`, `date`, `hostname`, `uptime`, `df`, `who`, `awk`, подстановка `$(...)`.

### Пример работы скрипта


Вывод:

```
Текущая дата: 2025-10-04 19:09:09
Имя хоста: myVirtualMachine
Время аптайма: up 4 minutes
Свободно на /: 22G
Пользователей в системе: 2
Здравствуйте, Kostya (I2302)!
```

![image](https://i.imgur.com/e9YzoaL.png)

### Результат

Скрипт корректно выполняет все проверки, работает стабильно и соответствует требованиям задания.

---

## Задание 2 — Резервное копирование с логированием

### Цель

Закрепить навыки работы с аргументами, проверками каталогов и утилитами `tar`, `du`, `date`, `ls`.
Реализовать архивирование и ведение журнала логов с ротацией.

### Ход выполнения

Создан скрипт **`backup_rot.sh`**, который:

* принимает путь к источнику (`SRC_DIR`) и опционально каталог для бэкапов (`DST_DIR`, по умолчанию — `~/backups`);
* проверяет существование каталога и права на запись;
* создаёт архив с именем `backup_<name>_<YYYYMMDD_HHMMSS>.tar.gz`;
* добавляет запись в `backup.log` (время, путь, имя файла, размер, статус);
* поддерживает ротацию (`KEEP_N` — количество сохраняемых архивов).

#### Пример работы

Команды:

```bash
mkdir -p ~/data
echo "demo" > ~/data/file.txt
./backup_rot.sh ~/data
```

Результат:

```
Создан архив: /home/kraaddys/backups/backup_data_20251004_191522.tar.gz (размер ~4.0K)
```

Файл лога:

```
2025-10-04T19:15:22Z SRC=/home/kraaddys/data DST=/home/kraaddys/backups FILE=backup_data_20251004_191522.tar.gz SIZE=4.0K STATUS=0
```

![image](https://i.imgur.com/mpHm6bl.png)

### Результат

Скрипт полностью соответствует требованиям: создаёт архив, логирует действия, проверяет входные данные и корректно обрабатывает ошибки.

---

## Задание 3 — Мониторинг дискового пространства

### Цель

Научиться использовать системные команды для анализа состояния дисков (`df`, `awk`, `date`) и реализовать пороговые проверки.

### Ход выполнения

Создан скрипт **`disk_monitor.sh`**, который:

* принимает путь к файловой системе и порог заполнения (%), по умолчанию 80%;
* выводит дату, путь, процент использования и статус («OK» или «WARNING»);
* возвращает код `0` при норме, `1` при превышении порога, `2` при ошибке пути.

Пример запуска:

```bash
./disk_monitor.sh / 75
```

Вывод:

```
2025-10-04 19:19:49
Путь: /
Использовано: 24%
Статус: OK.
```

![image](https://i.imgur.com/zZoVG28.png)

---

## Выводы

В ходе выполнения лабораторной работы:

* Освоено создание bash-скриптов с вводом/выводом, проверками и условиями;
* Реализованы три практических сценария: CLI-интерфейс, резервное копирование, мониторинг дисков;
* Отработаны навыки работы с системными командами (`tar`, `df`, `who`, `uptime`, `awk`, `date`);
* Все программы корректно выполняются в среде **Ubuntu** под **VirtualBox**.

